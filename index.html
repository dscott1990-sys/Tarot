<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mystic Oracle: Zodiac Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #c5a059; --blue: #0f0c29; --text: #f5f5f5; --glass: rgba(255, 255, 255, 0.05); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
        body { background: var(--blue); color: var(--text); font-family: 'Cormorant Garamond', serif; margin: 0; padding: 15px; text-align: center; line-height: 1.7; }
        .profile-section { background: var(--glass); border: 1px solid var(--gold); border-radius: 15px; padding: 15px; margin-bottom: 20px; font-size: 0.9rem; }
        input[type="date"] { background: transparent; border: 1px solid var(--gold); color: var(--gold); padding: 5px; border-radius: 5px; font-family: inherit; margin-top: 5px; }
        #moon { color: var(--gold); border: 1px solid var(--gold); padding: 6px 18px; border-radius: 25px; font-size: 0.85rem; display: inline-block; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; }
        h1 { color: var(--gold); letter-spacing: 4px; font-size: 1.8rem; margin: 10px 0; }
        .btn-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 25px; }
        .action-btn { background: var(--gold); color: var(--blue); border: none; padding: 12px 20px; border-radius: 30px; font-weight: bold; text-transform: uppercase; font-size: 0.75rem; min-width: 110px; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        #search { width: 100%; padding: 14px; border-radius: 30px; border: 1px solid var(--gold); background: var(--glass); color: white; margin-bottom: 25px; outline: none; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
        .tarot-card { background: rgba(0,0,0,0.4); border: 1px solid var(--gold); border-radius: 10px; padding: 8px; transition: 0.3s; position: relative; cursor: pointer; }
        .tarot-card img { width: 100%; border-radius: 6px; display: block; background: #000; min-height: 155px; }
        .rev { transform: rotate(180deg); }
        .summary-box { grid-column: 1 / -1; background: var(--glass); border: 1px solid var(--gold); padding: 25px; border-radius: 20px; margin-top: 30px; text-align: left; animation: fadeIn 0.8s ease; }
        .insight-step { border-left: 2px solid var(--gold); padding-left: 15px; margin-bottom: 20px; }
        .step-label { color: var(--gold); font-weight: bold; font-size: 0.8rem; text-transform: uppercase; }
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); overflow-y: auto; padding: 40px 0; }
        .modal-content { background: var(--blue); margin: auto; padding: 25px; border: 1px solid var(--gold); width: 90%; max-width: 400px; border-radius: 20px; position: relative; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="profile-section">
    <label>Your Birth Date (For Personalized Readings):</label><br>
    <input type="date" id="dob" onchange="saveDOB()">
    <div id="zodiacInfo" style="margin-top:10px; color:var(--gold); font-weight:bold;"></div>
</div>

<div id="moon">âœ¨ Aligning Stars...</div>
<h1>MYSTIC ORACLE</h1>

<div class="btn-container">
    <button class="action-btn" onclick="draw(1)">Daily</button>
    <button class="action-btn" onclick="draw(3)">3-Card</button>
    <button class="action-btn" onclick="draw(5)">5-Card</button>
</div>

<input type="text" id="search" placeholder="Search the 78 cards..." onkeyup="filter()">
<div class="card-grid" id="grid"></div>

<div id="modal" class="modal">
    <div class="modal-content">
        <span style="float:right; cursor:pointer; color:var(--gold); font-size:35px; line-height:20px;" onclick="closeM()">&times;</span>
        <img id="mImg" src="" style="width:140px; border-radius:8px; border:2px solid var(--gold); margin-bottom:15px;">
        <h2 id="mTitle" style="color:var(--gold); margin:10px 0;"></h2>
        <p id="mDesc" style="font-style:italic; font-size: 1.15rem; color: #ddd;"></p>
    </div>
</div>

<script>
// ALL 78 CARDS WITH AUDITED IMAGE LINKS
const cards = [
    { n: "The Fool", img: "https://upload.wikimedia.org/wikipedia/commons/9/90/RWS_Tarot_00_Fool.jpg", g: "A fresh journey begins; trust the universe and take a leap into the unknown.", r: "Be wary of recklessness; lack of preparation may lead to a mistake." },
    { n: "The Magician", img: "https://upload.wikimedia.org/wikipedia/commons/d/de/RWS_Tarot_01_Magician.jpg", g: "You possess all tools needed to manifest desires; take inspired action now.", r: "Your power is being misused; clarify intentions before moving forward." },
    { n: "The High Priestess", img: "https://upload.wikimedia.org/wikipedia/commons/8/88/RWS_Tarot_02_High_Priestess.jpg", g: "Sit in silence; your intuition holds the secret answers you seek.", r: "Ignoring your inner voice; stop looking for external validation." },
    { n: "The Empress", img: "https://upload.wikimedia.org/wikipedia/commons/a/af/RWS_Tarot_03_Empress.jpg", g: "Abundance and creativity surround you; nurture your dreams and watch them grow.", r: "Creative drought; reconnect with nature to replenish your spirit." },
    { n: "The Emperor", img: "https://upload.wikimedia.org/wikipedia/commons/c/c3/RWS_Tarot_04_Emperor.jpg", g: "Structure required; lead with logic and establish firm boundaries.", r: "Authority too rigid; avoid being overly controlling toward others." },
    { n: "The Hierophant", img: "https://upload.wikimedia.org/wikipedia/commons/8/8d/RWS_Tarot_05_Hierophant.jpg", g: "Seek wisdom in tradition; following the established path provides safety.", r: "Break free from tradition; it is time to challenge the status quo." },
    { n: "The Lovers", img: "https://upload.wikimedia.org/wikipedia/commons/d/db/RWS_Tarot_06_Lovers.jpg", g: "Harmony and soul-aligning choices; follow your heart toward deep union.", r: "Values out of alignment; resolve conflict before fixing relationships." },
    { n: "The Chariot", img: "https://upload.wikimedia.org/wikipedia/commons/9/9b/RWS_Tarot_07_Chariot.jpg", g: "Victory through willpower; stay focused and drive toward your goal.", r: "Losing control; pull back and realign your sense of direction." },
    { n: "Strength", img: "https://upload.wikimedia.org/wikipedia/commons/f/f5/RWS_Tarot_08_Strength.jpg", g: "Power lies in gentleness; tame your inner beast with patience.", r: "Self-doubt is draining; find the inner resolve to continue." },
    { n: "The Hermit", img: "https://upload.wikimedia.org/wikipedia/commons/4/4d/RWS_Tarot_09_Hermit.jpg", g: "Step back from noise; solitude reveals inner light and guidance.", r: "Isolation is a cage; do not hide from the world out of fear." },
    { n: "Wheel of Fortune", img: "https://upload.wikimedia.org/wikipedia/commons/3/3c/RWS_Tarot_10_Wheel_of_Fortune.jpg", g: "Cycles turning in your favor; embrace the destiny and change.", r: "Luck feels out of reach; accept the ebb and flow of fate." },
    { n: "Justice", img: "https://upload.wikimedia.org/wikipedia/commons/e/e0/RWS_Tarot_11_Justice.jpg", g: "Truth will prevail; ensure your actions align with highest integrity.", r: "Injustice is occurring; take accountability and seek honesty." },
    { n: "The Hanged Man", img: "https://upload.wikimedia.org/wikipedia/commons/2/2b/RWS_Tarot_12_Hanged_Man.jpg", g: "Surrender to the pause; a shift in perspective is valuable.", r: "Stalling for no reason; stop waiting and make a choice." },
    { n: "Death", img: "https://upload.wikimedia.org/wikipedia/commons/d/d7/RWS_Tarot_13_Death.jpg", g: "A cycle is ending to make room for a necessary new beginning.", r: "Clinging to a dead situation; let go so transformation begins." },
    { n: "Temperance", img: "https://upload.wikimedia.org/wikipedia/commons/f/f8/RWS_Tarot_14_Temperance.jpg", g: "Balance leads to peace; blend opposing forces for a harmonious life.", r: "Excess creating disharmony; find middle ground to regain peace." },
    { n: "The Devil", img: "https://upload.wikimedia.org/wikipedia/commons/5/55/RWS_Tarot_15_Devil.jpg", g: "Beware of unhealthy attachments; you can break the chains.", r: "Release from toxic patterns is within reach; choose freedom." },
    { n: "The Tower", img: "https://upload.wikimedia.org/wikipedia/commons/5/53/RWS_Tarot_16_Tower.jpg", g: "Upheaval clears false foundations; embrace chaos for breakthrough.", r: "Disaster avoided; use this warning to change your course now." },
    { n: "The Star", img: "https://upload.wikimedia.org/wikipedia/commons/d/db/RWS_Tarot_17_Star.jpg", g: "Hope and healing are returning; trust the universe guides you.", r: "Disconnected from hope; look for silver lining in the dark." },
    { n: "The Moon", img: "https://upload.wikimedia.org/wikipedia/commons/7/7f/RWS_Tarot_18_Moon.jpg", g: "Things are not as they seem; trust intuition to guide you.", r: "Confusion lifting; truth is emerging from darkness of fears." },
    { n: "The Sun", img: "https://upload.wikimedia.org/wikipedia/commons/1/17/RWS_Tarot_19_Sun.jpg", g: "Radiant joy and success are yours; bask in the light of vitality.", r: "Joy is clouded; find what is blocking light and clear it." },
    { n: "Judgement", img: "https://upload.wikimedia.org/wikipedia/commons/d/dd/RWS_Tarot_20_Judgement.jpg", g: "Higher calling heard; forgive the past and step into your life.", r: "Too self-critical; stop judging and accept grace offered." },
    { n: "The World", img: "https://upload.wikimedia.org/wikipedia/commons/f/ff/RWS_Tarot_21_World.jpg", g: "Cycle complete; celebrate achievements and prepare for new journeys.", r: "Seeking closure; tie up loose ends to move forward freely." },
    { n: "Ace of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/1/11/Wands01.jpg", g: "Spark of fire; a passionate new opportunity is presenting itself.", r: "Idea failing to launch; find the fuel to restart." },
    { n: "Two of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/0/0f/Wands02.jpg", g: "Planning and progress; stepping out of your comfort zone now.", r: "Fear of unknown holding you back; commit to your vision." },
    { n: "Three of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/f/ff/Wands03.jpg", g: "Foresight; your ships are coming in and rewards are visible.", r: "Playing it too safe; stop waiting and start next phase." },
    { n: "Four of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/a/a4/Wands04.jpg", g: "Joy; your hard work earned you a stable foundation.", r: "Tension at home; find common ground through honest celebration." },
    { n: "Five of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/9/9d/Wands05.jpg", g: "Competition; use friction to sharpen your skills and resolve.", r: "Avoiding conflict is causing tension; address the energy now." },
    { n: "Six of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/3/3b/Wands06.jpg", g: "Victory; your efforts are being recognized by those around.", r: "Private achievement; don't let lack of praise dim success." },
    { n: "Seven of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/e/e4/Wands07.jpg", g: "Grit; hold your ground against the challenges coming your way.", r: "Exhaustion; do not give up just as the summit is near." },
    { n: "Eight of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/6/6b/Wands08.jpg", g: "Sudden speed; news arriving quickly and everything is moving.", r: "Chaos; slow down before the momentum causes a crash." },
    { n: "Nine of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/4/4d/Wands09.jpg", g: "Resilience; stay strong as you finish this long cycle.", r: "Burnout; you are struggling to keep the guard up longer." },
    { n: "Ten of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/0/0b/Wands10.jpg", g: "Heavy burden; you are carrying a massive load nearing completion.", r: "Collapse imminent; delegate tasks before the weight breaks spirit." },
    { n: "Page of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/6/6a/Wands11.jpg", g: "Inspiration; follow the spark of a fresh creative idea.", r: "Idea lacks direction; don't let excitement lead to distraction." },
    { n: "Knight of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Wands12.jpg", g: "Action; chase passions with fearless energy and bold moves.", r: "Impulsive; slow down before restless energy causes a mistake." },
    { n: "Queen of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/0/0d/Wands13.jpg", g: "Confidence; lead with magnetic personality and warm heart.", r: "Self-respect needed; stop seeking attention and find fire." },
    { n: "King of Wands", img: "https://upload.wikimedia.org/wikipedia/commons/c/ce/Wands14.jpg", g: "Leadership; inspire others through bold actions and authority.", r: "Overbearing; avoid being a tyrant in pursuit of success." },
    { n: "Ace of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/3/36/Cups01.jpg", g: "Love; open heart to a beautiful new emotional beginning.", r: "Blocked; learn to love yourself before the cup can overflow." },
    { n: "Two of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/f/f8/Cups02.jpg", g: "Bonds; a unified connection brings deep harmony to life.", r: "Disharmony; self-love required to heal the external rift." },
    { n: "Three of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/7/7a/Cups03.jpg", g: "Friendship; gather with community to share joy and spirit.", r: "Isolation; find balance between social life and solitude." },
    { n: "Four of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/3/35/Cups04.jpg", g: "Apathy; don't ignore the new offers being presented now.", r: "Moving on from boredom; you are finally waking up again." },
    { n: "Five of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/d/d7/Cups05.jpg", g: "Regret; look behind you at the cups still standing now.", r: "Self-forgiveness; finally letting go of old, heavy sorrows." },
    { n: "Six of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/1/17/Cups06.jpg", g: "Nostalgia; reconnect with simple innocence of your past.", r: "Stuck in past; live for the future rather than memories." },
    { n: "Seven of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/a/af/Cups07.jpg", g: "Choices; evaluate options carefully before committing to dream.", r: "Clarity returning; fog of indecision clearing from vision." },
    { n: "Eight of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/6/60/Cups08.jpg", g: "Walking away; leaving behind what no longer serves soul.", r: "Stuck; you are afraid to leave the comfort of misery." },
    { n: "Nine of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/2/24/Cups09.jpg", g: "Bliss; wishes are granted through deep inner contentment.", r: "Greed; ensure success is fulfilling heart, not just ego." },
    { n: "Ten of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/d/dc/Cups10.jpg", g: "Divine love; home and family life reaching peak harmony.", r: "Disconnected; heal rift in domestic life through compassion." },
    { n: "Page of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/a/ad/Cups11.jpg", g: "Creative news; a message arriving to touch your heart.", r: "Doubting intuition; don't let insecurity block the message." },
    { n: "Knight of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/f/fa/Cups12.jpg", g: "Charm; a dreamer arrives with a poetic invitation for you.", r: "Moody; stay grounded so moods don't wash away progress." },
    { n: "Queen of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/6/62/Cups13.jpg", g: "Compassion; nurture yourself and others with kind spirit.", r: "Insecurity; take time to fill own cup before helping others." },
    { n: "King of Cups", img: "https://upload.wikimedia.org/wikipedia/commons/0/04/Cups14.jpg", g: "Balanced; lead with compassion and keep heart steady.", r: "Manipulative; do not use your emotions to control others." },
    { n: "Ace of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/1/1a/Swords01.jpg", g: "Mental clarity; a sharp new idea cuts through the fog.", r: "Chaos; your thoughts are too scattered to see the truth." },
    { n: "Two of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/9/9e/Swords02.jpg", g: "Stalemate; you must weigh options with total, cold logic.", r: "Indecision; you have information, now you must choose." },
    { n: "Three of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/0/02/Swords03.jpg", g: "Heartbreak; allow the pain to be felt so it is released.", r: "Healing; the worst of the emotional storm has passed." },
    { n: "Four of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/b/bf/Swords04.jpg", g: "Rest; take a sanctuary for mind before battle continues.", r: "Exhaustion; you are ignoring the need for rest and recovery." },
    { n: "Five of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/2/23/Swords05.jpg", g: "Conflict; winning at any cost may leave you feeling alone.", r: "Peace; it is time to lay down the weapons and talk." },
    { n: "Six of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/2/29/Swords06.jpg", g: "Transition; moving toward calmer waters and leaving trouble.", r: "Stuck; you are carrying too much baggage into your new path." },
    { n: "Seven of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/3/34/Swords07.jpg", g: "Strategy; act with caution and keep your plans close.", r: "Guilt; the truth about your hidden actions is coming out." },
    { n: "Eight of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/a/a7/Swords08.jpg", g: "Mental prison; only thing holding you back is your thoughts.", r: "Release; you are finally stepping out of the mental cage." },
    { n: "Nine of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/2/2f/Swords09.jpg", g: "Anxiety; your fears are louder than reality, but can't hurt.", r: "Recovery; the darkness of mind is being replaced by light." },
    { n: "Ten of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/d/d4/Swords10.jpg", g: "Rock bottom; the worst happened, now only path is upward.", r: "Rise; you are surviving the crisis and starting to heal." },
    { n: "Page of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/4/4c/Swords11.jpg", g: "Curiosity; a sharp new perspective is ready to be shared.", r: "All talk; don't let your bluntness hurt those you love." },
    { n: "Knight of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/b/b0/Swords12.jpg", g: "Drive; rush toward goals with focus and sharp intellect.", r: "Cruel; do not let your ambition trample over others' hearts." },
    { n: "Queen of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/d/d4/Swords13.jpg", g: "Logic; use your independence to see the situation clearly.", r: "Cold; your logic has become a weapon rather than a tool." },
    { n: "King of Swords", img: "https://upload.wikimedia.org/wikipedia/commons/3/33/Swords14.jpg", g: "Mental power; speak truth with conviction and ethical clarity.", r: "Tyranny; your power is used to control others through fear." },
    { n: "Ace of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Pents01.jpg", g: "Wealth; a seed is planted for long-term stable growth.", r: "Missed chance; you are failing to see the gold before you." },
    { n: "Two of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/9/9f/Pents02.jpg", g: "Balance; manage resources with flexibility and steady grace.", r: "Chaos; the balls you are juggling are starting to fall." },
    { n: "Three of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/4/42/Pents03.jpg", g: "Teamwork; your skills are recognized when you work together.", r: "Disharmony; lack of teamwork is hurting the final product." },
    { n: "Four of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/3/35/Pents04.jpg", g: "Security; hold onto resources to build a safe future.", r: "Greed; your need for control is blocking the abundance." },
    { n: "Five of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/9/96/Pents05.jpg", g: "Hardship; do not ignore the help being offered in darkness.", r: "Recovery; the financial or spiritual drought is ending now." },
    { n: "Six of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Pents06.jpg", g: "Generosity; the universe rewards your balance of resources.", r: "Debt; the flow of giving and receiving is currently broken." },
    { n: "Seven of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/6/6a/Pents07.jpg", g: "Patience; your long-term efforts are starting to bear fruit.", r: "Delay; you are working hard but not seeing the results yet." },
    { n: "Eight of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/4/49/Pents08.jpg", g: "Mastery; focus on repetitive work to reach perfection.", r: "Rush; you are rushing the process and hurting the result." },
    { n: "Nine of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/f/f0/Pents09.jpg", g: "Abundance; enjoy the fruits of labor in your own sanctuary.", r: "Greed; do not let your success isolate you from the world." },
    { n: "Ten of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/3/39/Pents10.jpg", g: "Legacy; your long-term security is established for family.", r: "Loss; the stability you built is currently under threat." },
    { n: "Page of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/e/ec/Pents11.jpg", g: "Opportunity; a practical new path for learning is opening.", r: "Procrastination; dreams lack the necessary practical work." },
    { n: "Knight of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/d/d5/Pents12.jpg", g: "Hard work and productivity; the slow, steady path is the surest.", r: "Stuck; your routine has become a rut rather than progress." },
    { n: "Queen of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/8/88/Pents13.jpg", g: "Nurturing; provide for home and health with grounded energy.", r: "Deficit; providing for everyone else but ignoring yourself." },
    { n: "King of Pentacles", img: "https://upload.wikimedia.org/wikipedia/commons/1/1c/Pents14.jpg", g: "Abundance; your mastery of physical world provides safety.", r: "Stubborn; focus on money is blinding you to truth." }
];

function moon() {
    const p = ["ðŸŒ‘ New", "ðŸŒ’ Waxing", "ðŸŒ“ First", "ðŸŒ” Gibbous", "ðŸŒ• Full", "ðŸŒ– Waning", "ðŸŒ— Last", "ðŸŒ˜ Crescent"];
    document.getElementById('moon').innerText = p[new Date().getDate() % 8] + " Moon Guidance";
}
moon();

function saveDOB() {
    const d = document.getElementById('dob').value;
    localStorage.setItem('mystic_dob', d);
    showZodiac(d);
}

function showZodiac(dateStr) {
    if(!dateStr) return "";
    const date = new Date(dateStr);
    const m = date.getMonth() + 1;
    const d = date.getDate();
    const signs = [
        {n:"Capricorn", e:"Earth", start:[12,22]}, {n:"Aquarius", e:"Air", start:[1,20]},
        {n:"Pisces", e:"Water", start:[2,19]}, {n:"Aries", e:"Fire", start:[3,21]},
        {n:"Taurus", e:"Earth", start:[4,20]}, {n:"Gemini", e:"Air", start:[5,21]},
        {n:"Cancer", e:"Water", start:[6,21]}, {n:"Leo", e:"Fire", start:[7,23]},
        {n:"Virgo", e:"Earth", start:[8,23]}, {n:"Libra", e:"Air", start:[9,23]},
        {n:"Scorpio", e:"Water", start:[10,23]}, {n:"Sagittarius", e:"Fire", start:[11,22]}
    ];
    let sign = signs[11];
    for(let i=0; i<11; i++) {
        if((m == signs[i].start[0] && d >= signs[i].start[1]) || (m == signs[i+1].start[0] && d < signs[i+1].start[1])) {
            sign = signs[i]; break;
        }
    }
    document.getElementById('zodiacInfo').innerText = "Vibe: " + sign.n + " (" + sign.e + ")";
    return sign;
}

// Load saved DOB on start
const saved = localStorage.getItem('mystic_dob');
if(saved) { document.getElementById('dob').value = saved; showZodiac(saved); }

function render(list) {
    document.getElementById('grid').innerHTML = list.map(c => `
        <div class="tarot-card" onclick="openM('${c.n.replace(/'/g, "\\'")}')">
            <img src="${c.img}" loading="lazy">
            <h3 style="font-size:0.75rem; margin:5px 0; color:var(--gold);">${c.n}</h3>
        </div>
    `).join('');
}

window.openM = function(name, rev = false) {
    const card = cards.find(c => c.n === name);
    document.getElementById('mImg').src = card.img;
    document.getElementById('mImg').className = rev ? 'rev' : '';
    document.getElementById('mTitle').innerText = name + (rev ? " (Rev)" : "");
    document.getElementById('mDesc').innerText = rev ? card.r : card.g;
    document.getElementById('modal').style.display = 'block';
}

function closeM() { document.getElementById('modal').style.display = 'none'; }

window.draw = function(num) {
    const shuffled = [...cards].sort(() => 0.5 - Math.random());
    const picked = shuffled.slice(0, num);
    const labels = ["The Past", "The Present", "The Future", "The Root", "The Outcome"];
    let stepHtml = "";
    const grid = document.getElementById('grid');
    grid.innerHTML = `<div style="grid-column:1/-1;"><button class="action-btn" onclick="location.reload()">Reset Deck</button></div>`;
    picked.forEach((c, i) => {
        const isR = Math.random() > 0.7;
        const msg = isR ? c.r : c.g;
        stepHtml += `<div class="insight-step"><span class="step-label">${labels[i]}: ${c.n} ${isR?'(Rev)':''}</span><br>${msg}</div>`;
        grid.innerHTML += `
            <div class="tarot-card" onclick="openM('${c.n.replace(/'/g, "\\'")}', ${isR})">
                <div style="font-size:0.65rem; color:var(--gold); font-weight:bold;">${labels[i]}</div>
                <img src="${c.img}" class="${isR ? 'rev' : ''}">
                <h3 style="font-size:0.75rem;">${c.n}</h3>
            </div>`;
    });
    
    const synthesis = generateDeepSummary(picked);
    grid.innerHTML += `<div class="summary-box"><h3 style="color:var(--gold);margin:0 0 10px 0;">The Oracle's Insights</h3>${stepHtml}<hr style="border:0;border-top:1px solid var(--gold);opacity:0.3;margin:15px 0;"><p><strong>Personal Synthesis:</strong> ${synthesis}</p></div>`;
}

function generateDeepSummary(picked) {
    const sign = showZodiac(localStorage.getItem('mystic_dob'));
    const majors = picked.filter(c => !c.n.includes("of")).length;
    const cups = picked.filter(c => c.n.includes("Cups")).length;
    const swords = picked.filter(c => c.n.includes("Swords")).length;
    const pents = picked.filter(c => c.n.includes("Pentacles")).length;
    const wands = picked.filter(c => c.n.includes("Wands")).length;

    let narrative = "As the cards settle, a distinct narrative emerges. ";
    
    if(sign) {
        narrative += "As a " + sign.n + ", your " + sign.e + " nature is being called to integrate these messages. ";
        if(sign.e == "Fire") narrative += "Channel your natural passion into the movement shown here. ";
        if(sign.e == "Water") narrative += "Trust your deep emotional intelligence to navigate this path. ";
        if(sign.e == "Earth") narrative += "Stay grounded and focus on the tangible steps ahead. ";
        if(sign.e == "Air") narrative += "Use your mental clarity to organize the chaos. ";
    }

    if (majors >= 2) narrative += "With several Major Arcana present, you are in a season of soul-level transition. ";
    else narrative += "Your energy is grounded in practical day-to-day rhythms. ";

    if (cups >= 2) narrative += "The dominance of Cups suggests your heart is leading right now. ";
    else if (swords >= 2) narrative += "A heavy Sword presence indicates a busy mental space. ";
    else if (wands >= 2) narrative += "The fire of Wands shows a season of creation and drive. ";
    else if (pents >= 2) narrative += "The stability of Pentacles shows a focus on your physical world. ";

    narrative += "The universe invites you to trust the quiet whispers of your own soul.";
    return narrative;
}

window.filter = function() {
    const q = document.getElementById('search').value.toLowerCase();
    render(cards.filter(c => c.n.toLowerCase().includes(q)));
}

render(cards);
</script>
</body>
</html>
